<!doctype html>
<html lang="id">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0" />
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
            crossorigin="anonymous"
        />
        <title>Ulang Tahun</title>
        <style>
            * {
                box-sizing: border-box;
                margin: 0;
                padding: 0;
            }

            body {
                min-height: 100vh;
                width: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                font-family: "Arial", sans-serif;
                overflow-x: hidden;
                background: linear-gradient(135deg, #e0f7d4, #90c8ac, #5a8c7a);
                padding: 20px;
            }

            body.birthday-bg {
                background: #0a1f14;
            }

            .main-container {
                width: 100%;
                max-width: 450px;
                display: flex;
                flex-direction: column;
                gap: 20px;
            }

            .form-box {
                background: white;
                padding: 25px;
                border-radius: 15px;
                text-align: center;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            }

            h2 {
                margin-bottom: 20px;
                color: #1a472a;
                font-size: 24px;
            }

            .input-group {
                margin-top: 15px;
                text-align: left;
            }

            .input-group label {
                display: block;
                margin-bottom: 5px;
                color: #1a472a;
                font-weight: 600;
                font-size: 14px;
            }

            input[type="text"],
            input[type="date"] {
                width: 100%;
                padding: 12px;
                border-radius: 8px;
                border: 2px solid #c8e6c9;
                font-size: 16px;
                background: #f9fdf9;
            }

            input:focus {
                outline: none;
                border-color: #2e7d32;
            }

            /* MUSIK SECTION */
            .music-section {
                margin-top: 20px;
                padding: 15px;
                background: #f0f8f0;
                border-radius: 10px;
                border: 2px solid #c8e6c9;
            }

            .music-title {
                color: #2e7d32;
                margin-bottom: 10px;
                font-size: 16px;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            .music-select {
                width: 100%;
                padding: 10px;
                border-radius: 8px;
                border: 2px solid #c8e6c9;
                background: white;
                font-size: 14px;
                margin-bottom: 10px;
            }

            .music-info {
                font-size: 12px;
                color: #666;
                margin-top: 5px;
                text-align: center;
            }

            button#submitBtn {
                margin-top: 20px;
                padding: 12px;
                background: linear-gradient(135deg, #2e7d32, #1b5e20);
                color: white;
                border: none;
                border-radius: 8px;
                cursor: pointer;
                font-size: 16px;
                font-weight: 600;
                width: 100%;
                transition: all 0.3s;
            }

            button#submitBtn:hover {
                background: linear-gradient(135deg, #1b5e20, #0d3c13);
            }

            /* BAGIAN TEKS ULANG TAHUN */
            .birthday-message {
                font-size: 22px;
                font-weight: bold;
                color: #2e7d32;
                background: rgba(255, 255, 255, 0.98);
                padding: 20px;
                border-radius: 12px;
                text-align: center;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                border: 3px solid #4caf50;
                animation: pulse 1.5s infinite alternate;
                z-index: 100;
                position: relative;
                margin-bottom: 15px;
                line-height: 1.4;
            }

            @keyframes pulse {
                from {
                    transform: scale(1);
                }
                to {
                    transform: scale(1.02);
                }
            }

            /* KUE DAN LILIN */
            .cake-container {
                position: relative;
                width: 100%;
                height: 120px;
                display: flex;
                justify-content: center;
                align-items: flex-end;
                margin-top: 10px;
            }

            .cake {
                width: 250px;
                height: 70px;
                background: linear-gradient(135deg, #525252, #9c9c9c, #dcdcdc);
                border-radius: 0 0 15px 15px;
                position: relative;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                z-index: 2;
            }

            .cake-top {
                position: absolute;
                top: -10px;
                left: 10px;
                right: 10px;
                height: 20px;
                background: linear-gradient(135deg, #51944783, #6fc26283);
                border-radius: 10px 10px 0 0;
            }

            /* LILIN - 5 BUAH DI ATAS KUE */
            .candles-container {
                position: absolute;
                bottom: 50px;
                left: 0;
                right: 0;
                display: flex;
                justify-content: center;
                gap: 20px;
                padding: 0 10px;
                z-index: 3;
            }

            .candle {
                width: 10px;
                height: 40px;
                background: linear-gradient(to bottom, #ffffff, #f0f0f0);
                border-radius: 3px;
                position: relative;
                cursor: pointer;
                box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
                transition: all 0.3s ease;
            }

            .candle:hover {
                transform: translateY(-3px);
                box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
            }

            /* API LILIN */
            .flame {
                position: absolute;
                top: -15px;
                left: 50%;
                transform: translateX(-50%);
                width: 14px;
                height: 20px;
                background: radial-gradient(circle, #ffff00, #ff8800, #ff0000);
                border-radius: 50% 50% 20% 20%;
                animation: flicker 0.2s infinite alternate;
                box-shadow: 0 0 10px #ff9900;
                z-index: 4;
            }

            .flame.color2 {
                background: radial-gradient(circle, #ffff80, #ffaa00, #ff5500);
            }

            .flame.color3 {
                background: radial-gradient(circle, #ffffff, #ff9900, #ff4400);
            }

            .flame.color4 {
                background: radial-gradient(circle, #ffffc0, #ffbb66, #ff6600);
            }

            .flame.color5 {
                background: radial-gradient(circle, #ffcc00, #ff6600, #ff3300);
            }

            .flame.extinguished {
                animation: none;
                opacity: 0;
                transform: translateX(-50%) scale(0);
                transition: all 0.5s;
            }

            .candle.extinguished {
                background: linear-gradient(to bottom, #cccccc, #aaaaaa);
                opacity: 0.6;
                cursor: default;
            }

            @keyframes flicker {
                0% {
                    transform: translateX(-50%) scale(0.9) rotate(-2deg);
                }
                50% {
                    transform: translateX(-50%) scale(1.1) rotate(2deg);
                }
                100% {
                    transform: translateX(-50%) scale(1) rotate(0deg);
                }
            }

            /* CAROUSEL STYLE */
            .birthday-carousel {
                width: 100%;
                max-width: 400px;
                margin: 20px auto;
                border-radius: 10px;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            }

            .birthday-carousel .carousel-item img {
                height: 200px;
                object-fit: cover;
            }

            /* TOMBOL RESET */
            .reset-btn {
                margin-top: 15px;
                padding: 10px 20px;
                background: linear-gradient(135deg, #4caf50, #2e7d32);
                color: white;
                border: none;
                border-radius: 20px;
                cursor: pointer;
                font-size: 14px;
                display: none;
            }

            .reset-btn:hover {
                background: linear-gradient(135deg, #2e7d32, #1b5e20);
            }

            /* KONFETI */
            .confetti {
                position: fixed;
                width: 8px;
                height: 8px;
                border-radius: 50%;
                animation: fall 3s linear forwards;
                z-index: 0;
                pointer-events: none;
            }

            @keyframes fall {
                from {
                    transform: translateY(-100px) rotate(0deg);
                    opacity: 1;
                }
                to {
                    transform: translateY(100vh) rotate(360deg);
                    opacity: 0;
                }
            }

            /* BACKGROUND API */
            .fire-bg {
                position: fixed;
                inset: 0;
                background: radial-gradient(
                    circle at 50% 50%,
                    rgba(255, 200, 100, 0.2),
                    transparent 70%
                );
                animation: fireMove 3s infinite alternate;
                z-index: -1;
                display: none;
            }

            .fire-bg.active {
                display: block;
            }

            @keyframes fireMove {
                from {
                    filter: blur(15px);
                    transform: scale(1);
                }
                to {
                    filter: blur(25px);
                    transform: scale(1.05);
                }
            }

            /* STYLE UNTUK BUKAN HARI ULANG TAHUN */
            .normal-message {
                font-size: 18px;
                color: #1a472a;
                background: rgba(255, 255, 255, 0.95);
                padding: 15px;
                border-radius: 10px;
                text-align: center;
                box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
                border: 2px solid #90c8ac;
                margin-bottom: 15px;
                line-height: 1.4;
            }

            /* MUSIK CONTROL */
            .music-control {
                margin-top: 10px;
                display: flex;
                gap: 10px;
                justify-content: center;
            }

            .music-control button {
                padding: 8px 15px;
                background: #4caf50;
                color: white;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 14px;
            }

            .music-control button.stop {
                background: #f44336;
            }

            /* STYLE TOAST */
            .toast-container {
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 9999;
            }

            .custom-toast {
                background: linear-gradient(135deg, #000000, #083c14);
                color: white;
                border: none;
                border-radius: 10px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                min-width: 300px;
            }

            .toast-header-custom {
                background: rgba(255, 255, 255, 0.2);
                border-bottom: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                border-radius: 10px 10px 0 0;
                padding: 10px 15px;
            }

            .toast-body-custom {
                padding: 15px;
                font-size: 16px;
                font-weight: 500;
            }

            .toast-close-btn {
                color: white;
                opacity: 0.8;
                filter: brightness(0) invert(1);
            }

            .toast-close-btn:hover {
                opacity: 1;
            }

            /* CARD STYLE */
            .custom-card {
                background: white;
                border-radius: 15px;
                overflow: hidden;
                box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
                border: 2px solid #78f57b;
                margin-top: 20px;
                transition: transform 0.3s;
            }

            .custom-card:hover {
                transform: translateY(-5px);
            }

            .card-img-top {
                width: 100%;
                height: 200px;
                object-fit: cover;
            }

            .card-body {
                padding: 20px;
            }

            .card-text {
                color: #1a472a;
                font-size: 16px;
                line-height: 1.5;
            }

            /* TOMBOL KEMBALI */
            .back-btn {
                margin-top: 15px;
                padding: 10px 20px;
                background: linear-gradient(135deg, #2196f3, #1976d2);
                color: white;
                border: none;
                border-radius: 20px;
                cursor: pointer;
                font-size: 14px;
            }

            .back-btn:hover {
                background: linear-gradient(135deg, #1976d2, #0d47a1);
            }

            /* GALLERY CONTAINER */
            .gallery-container {
                display: flex;
                flex-direction: column;
                gap: 20px;
                margin-top: 20px;
            }

            .gallery-card {
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                border: 2px solid;
                transition: all 0.3s ease;
            }

            .gallery-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
                border-color: #4fd66e;
            }

            .gallery-img {
                width: 100%;
                height: 180px;
                object-fit: cover;
                border-bottom: 3px solid #4fd66e;
            }

            .gallery-card-body {
                padding: 15px;
            }

            .gallery-card-title {
                color: #08260f;
                font-size: 16px;
                font-weight: bold;
                margin-bottom: 8px;
                text-align: center;
            }

            .gallery-card-text {
                color: #666;
                font-size: 14px;
                line-height: 1.5;
                text-align: center;
            }

            /* RESPONSIF */
            @media (max-width: 480px) {
                .form-box {
                    padding: 20px;
                }

                .cake {
                    width: 220px;
                    height: 60px;
                }

                .candle {
                    width: 8px;
                    height: 35px;
                }

                .flame {
                    width: 12px;
                    height: 18px;
                    top: -12px;
                }

                .birthday-message {
                    font-size: 20px;
                    padding: 15px;
                }

                .candles-container {
                    gap: 15px;
                    bottom: 45px;
                }

                h2 {
                    font-size: 22px;
                }

                .birthday-carousel {
                    max-width: 350px;
                }

                .birthday-carousel .carousel-item img {
                    height: 180px;
                }

                .toast-container {
                    top: 10px;
                    right: 10px;
                    left: 10px;
                }

                .custom-toast {
                    min-width: auto;
                    width: 100%;
                }

                .custom-card {
                    margin-top: 15px;
                }

                .gallery-img {
                    height: 150px;
                }

                .gallery-card-body {
                    padding: 12px;
                }
            }

            @media (max-width: 360px) {
                .cake {
                    width: 200px;
                }

                .candle {
                    width: 7px;
                    height: 30px;
                }

                .candles-container {
                    gap: 12px;
                }

                .birthday-carousel {
                    max-width: 300px;
                }

                .birthday-carousel .carousel-item img {
                    height: 150px;
                }

                .gallery-img {
                    height: 140px;
                }
            }
        </style>
    </head>
    <body>
        <div class="fire-bg"></div>

        <!-- Toast Container -->
        <div class="toast-container" id="toastContainer"></div>

        <div class="main-container">
            <!-- Form input -->
            <div class="form-box" id="formBox">
                <h2>üéÇ Cek Ulang Tahun üéÇ</h2>

                <div class="input-group">
                    <label for="nameInput">Nama:</label>
                    <input
                        type="text"
                        id="nameInput"
                        placeholder="Masukkan nama"
                        autocomplete="off"
                    />
                </div>

                <div class="input-group">
                    <label for="birthdateInput">Tanggal Lahir:</label>
                    <input type="date" id="birthdateInput" />
                </div>

                <!-- PILIH MUSIK LATAR BELAKANG -->
                <div class="music-section">
                    <div class="music-title">
                        <span>üéµ</span>
                        <span>Pilih Musik Latar Belakang:</span>
                    </div>

                    <select id="musicSelect" class="music-select">
                        <option value="default">
                            üéµ Happy Birthday (Default)
                        </option>
                        <option value="custom">‚ûï Custom URL Musik</option>
                    </select>

                    <!-- Input custom URL -->
                    <div id="customUrlContainer" style="display: none">
                        <input
                            type="text"
                            id="musicUrlInput"
                            placeholder="Masukkan URL musik (MP3, M4A)"
                            class="music-select"
                            style="margin-top: 5px"
                        />
                        <div class="music-info">
                            Contoh: https://example.com/music.mp3
                        </div>
                    </div>
                </div>

                <button id="submitBtn">üéâ Cek Sekarang</button>
            </div>

            <!-- Container untuk pesan -->
            <div id="messageContainer"></div>

            <!-- Display ulang tahun -->
            <div id="birthdayDisplay" style="display: none">
                <div class="cake-container">
                    <!-- Kue -->
                    <div class="cake">
                        <div class="cake-top"></div>
                    </div>

                    <!-- 5 lilin di atas kue -->
                    <div class="candles-container" id="candlesContainer"></div>
                </div>

                <!-- CAROUSEL HANYA MUNCUL SAAT ULANG TAHUN -->
                <div
                    id="birthdayCarousel"
                    class="birthday-carousel"
                    style="display: none"
                >
                    <div id="carouselExampleIndicators" class="carousel slide">
                        <div class="carousel-indicators">
                            <button
                                type="button"
                                data-bs-target="#carouselExampleIndicators"
                                data-bs-slide-to="0"
                                class="active"
                                aria-current="true"
                                aria-label="Slide 1"
                            ></button>
                            <button
                                type="button"
                                data-bs-target="#carouselExampleIndicators"
                                data-bs-slide-to="1"
                                aria-label="Slide 2"
                            ></button>
                            <button
                                type="button"
                                data-bs-target="#carouselExampleIndicators"
                                data-bs-slide-to="2"
                                aria-label="Slide 3"
                            ></button>
                        </div>
                        <div class="carousel-inner">
                            <div class="carousel-item active">
                                <img
                                    src="SKY_1.jpg"
                                    class="d-block w-100"
                                    alt="Happy Birthday 1"
                                />
                            </div>
                            <div class="carousel-item">
                                <img
                                    src="SKY_2.jpg"
                                    class="d-block w-100"
                                    alt="Happy Birthday 2"
                                />
                            </div>
                            <div class="carousel-item">
                                <img
                                    src="SKY_3.jpg"
                                    class="d-block w-100"
                                    alt="Happy Birthday 3"
                                />
                            </div>
                        </div>
                        <button
                            class="carousel-control-prev"
                            type="button"
                            data-bs-target="#carouselExampleIndicators"
                            data-bs-slide="prev"
                        >
                            <span
                                class="carousel-control-prev-icon"
                                aria-hidden="true"
                            ></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button
                            class="carousel-control-next"
                            type="button"
                            data-bs-target="#carouselExampleIndicators"
                            data-bs-slide="next"
                        >
                            <span
                                class="carousel-control-next-icon"
                                aria-hidden="true"
                            ></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>

                <!-- Single Card -->
                <div class="custom-card">
                    <img
                        src="Lucu.jpg"
                        class="card-img-top"
                        alt="Happy Birthday"
                        style="
                            height: 200px;
                            object-fit: cover;
                            border-bottom: 3px solid #07552e83;
                        "
                    />

                    <div class="card-body">
                        <h5
                            style="
                                color: #00000083;
                                margin-bottom: 15px;
                                text-align: center;
                            "
                        >
                            HAPPY BIRTHDAY!
                        </h5>
                        <p
                            class="card-text"
                            style="
                                text-align: center;
                                font-size: 15px;
                                line-height: 1.6;
                            "
                        >
                            <strong>Untuk yang berulang tahun hari ini!</strong
                            ><br /><br />
                            Hai kau yang disana, hari ini adalah ulang
                            tahunmu..... ingat tersenyumlah ;) Semoga
                            bertambahnya usia membuatmu makin bijak, Teruslah
                            menjadi pribadi yang hangat, rendah hati, dan penuh
                            semangat seperti yang selama ini mr tunjukkan ü´∞ü´∞
                            <br /><br />
                            üéâ <em>Cemangat~~</em> üéâ
                        </p>
                    </div>
                </div>

                <!-- Gallery Cards -->
                <div class="gallery-container" id="galleryContainer">
                    <!-- Card Gallery 1 -->
                    <div class="gallery-card">
                        <img
                            src="Above.jpg"
                            class="gallery-img"
                            alt="Birthday Party"
                        />
                        <div class="gallery-card-body">
                            <h5 class="gallery-card-title">Waktu ‚è∞‚è±Ô∏è</h5>
                            <p class="gallery-card-text">
                                Waktu akan terus berjalan dengan caranya
                                sendiri.. Ada sedih, marah, kesal, dan banyak
                                lagi.. Cukup melelahkan,, tapi.. itu membuat
                                waktu bermakna. Hargailah waktumu sebaik-baiknya
                                dan belajarlah dari waktu ke waktu yang telah
                                dilewati ‚úåÔ∏èü´∞ 
                                (maap krng nyambung)
                            </p>
                        </div>
                    </div>

                    <!-- Card Gallery 2 -->
                    <div class="gallery-card">
                        <img
                            src="SKY_4.jpg"
                            class="gallery-img"
                            alt="Birthday Cake"
                        />
                        <div class="gallery-card-body">
                            <h5 class="gallery-card-title">A Piece üß©</h5>
                            <p class="gallery-card-text">
                                Thank you for letting me be a piece of your
                                life, even if only for a season, and on this
                                birthday i hope your dreams that grow brighter
                                with every year that passes, guided by God's..
                                and remind you that even the smallest pieces you
                                share with others can become memories that last
                                fat longer than candles on a cake üéÇ
                            </p>
                        </div>
                    </div>

                    <!-- Card Gallery 3 
                    <div class="gallery-card">
                        <img src="https://images.unsplash.com/photo-1512917774080-9991f1c4c750?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" 
                             class="gallery-img" 
                             alt="Celebration">
                        <div class="gallery-card-body">
                            <h5 class="gallery-card-title">‚ú® Magical Moment</h5>
                            <p class="gallery-card-text">
                                Momen ajaib dalam hidupmu. Abadikan kenangan indah ini!
                                Setiap tahun adalah bab baru yang penuh dengan peluang dan kebahagiaan.
                            </p>
                        </div>
                    </div>
                    -->
                    <!-- Card Gallery 4 
                    <div class="gallery-card">
                        <img src="https://images.unsplash.com/photo-1532117182044-031e7cd916ee?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" 
                             class="gallery-img" 
                             alt="Balloon Celebration">
                        <div class="gallery-card-body">
                            <h5 class="gallery-card-title">ü•≥ Celebration Joy</h5>
                            <p class="gallery-card-text">
                                Rayakan dengan penuh sukacita! Biarkan balon kebahagiaan terbang tinggi.
                                Hari ini adalah hari spesialmu, nikmati setiap detiknya!
                            </p>
                        </div>
                    </div>
                     -->
                    <!-- Card Gallery 5 -->
                    <div class="gallery-card">
                        <img
                            src="Smile.jpg"
                            class="gallery-img"
                            alt="Gifts and Presents"
                        />
                        <div class="gallery-card-body">
                            <h5 class="gallery-card-title">Smile ‚ò∫Ô∏è</h5>
                            <p class="gallery-card-text">
                                One last thing i want to say is this.. Brody,
                                keep that smile going.. because it's not just
                                about you. Your smile spreads good vibes and
                                positive energy to people around u. it really
                                hits different, trust me, and thank you for ur
                                smile.. Every day at school...üòäüòä
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Kontrol musik -->
                <div class="music-control">
                    <button id="playBtn">‚ñ∂ Putar Musik</button>
                    <button id="stopBtn" class="stop">‚èπ Hentikan</button>
                    <button id="backBtn" class="back-btn">‚Ü© Kembali</button>
                </div>

                <button id="resetBtn" class="reset-btn">
                    üî• Nyalakan Kembali Lilin
                </button>
            </div>
        </div>

        <!-- Bootstrap JS -->
        <script
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
            crossorigin="anonymous"
        ></script>

        <script>
            // ============================
            // KONFIGURASI MUSIK
            // ============================

            // DAFTAR MUSIK YANG SUDAH DISEDIAKAN
            const musicLibrary = {
                default: {
                    name: "Happy Birthday",
                    url: "birthday.m4a" // File Anda di folder yang sama
                }
            };

            // ============================
            // ELEMEN DOM
            // ============================
            const nameInput = document.getElementById("nameInput");
            const birthdateInput = document.getElementById("birthdateInput");
            const musicSelect = document.getElementById("musicSelect");
            const customUrlContainer =
                document.getElementById("customUrlContainer");
            const musicUrlInput = document.getElementById("musicUrlInput");
            const submitBtn = document.getElementById("submitBtn");
            const messageContainer =
                document.getElementById("messageContainer");
            const birthdayDisplay = document.getElementById("birthdayDisplay");
            const candlesContainer =
                document.getElementById("candlesContainer");
            const birthdayCarousel =
                document.getElementById("birthdayCarousel");
            const resetBtn = document.getElementById("resetBtn");
            const playBtn = document.getElementById("playBtn");
            const stopBtn = document.getElementById("stopBtn");
            const backBtn = document.getElementById("backBtn");
            const fireBg = document.querySelector(".fire-bg");
            const body = document.body;

            // ============================
            // VARIABEL GLOBAL
            // ============================
            let birthdayMusic = null;
            let isMusicPlaying = false;
            let currentMusicUrl = musicLibrary.default.url;

            // ============================
            // FUNGSI MUSIK
            // ============================

            // Fungsi untuk memainkan musik
            function playBirthdayMusic() {
                if (!birthdayMusic) {
                    birthdayMusic = new Audio(currentMusicUrl);
                    birthdayMusic.loop = true;
                    birthdayMusic.volume = 0.5;

                    // Fallback jika file tidak ditemukan
                    birthdayMusic.addEventListener("error", function (e) {
                        console.error("Error memuat musik:", e);
                        showErrorToast(
                            "‚ö†Ô∏è Gagal memuat musik. Menggunakan musik default online."
                        );
                        currentMusicUrl =
                            "https://assets.mixkit.co/music/preview/mixkit-happy-birthday-443.mp3";
                        birthdayMusic.src = currentMusicUrl;
                        birthdayMusic.play();
                    });
                }

                birthdayMusic
                    .play()
                    .then(() => {
                        isMusicPlaying = true;
                        updateMusicControls();
                    })
                    .catch(error => {
                        console.log(
                            "Musik tidak bisa diputar otomatis:",
                            error
                        );
                        playBtn.style.display = "block";
                    });
            }

            // Fungsi untuk menghentikan musik
            function stopBirthdayMusic() {
                if (birthdayMusic) {
                    birthdayMusic.pause();
                    birthdayMusic.currentTime = 0;
                    isMusicPlaying = false;
                    updateMusicControls();
                }
            }

            // Fungsi update tampilan kontrol musik
            function updateMusicControls() {
                if (isMusicPlaying) {
                    playBtn.textContent = "‚è∏ Jeda";
                    playBtn.style.background = "#ff9800";
                } else {
                    playBtn.textContent = "‚ñ∂ Putar Musik";
                    playBtn.style.background = "#4caf50";
                }
            }

            // ============================
            // EVENT LISTENERS MUSIK
            // ============================

            // Toggle custom URL input
            musicSelect.addEventListener("change", function () {
                if (this.value === "custom") {
                    customUrlContainer.style.display = "block";
                    musicUrlInput.focus();
                } else {
                    customUrlContainer.style.display = "none";
                    currentMusicUrl = musicLibrary.default.url;
                }
            });

            // Tombol play musik
            playBtn.addEventListener("click", function () {
                if (!isMusicPlaying) {
                    playBirthdayMusic();
                } else {
                    if (birthdayMusic) {
                        birthdayMusic.pause();
                        isMusicPlaying = false;
                        updateMusicControls();
                    }
                }
            });

            // Tombol stop musik
            stopBtn.addEventListener("click", function () {
                stopBirthdayMusic();
            });

            // ============================
            // FUNGSI UTAMA CEK ULANG TAHUN
            // ============================

            function checkBirthday() {
                const name = nameInput.value.trim();
                const birthdate = birthdateInput.value;

                // Validasi input
                if (!name) {
                    showErrorToast("Harap isi nama Anda!");
                    nameInput.focus();
                    return;
                }

                if (!birthdate) {
                    showErrorToast("Harap pilih tanggal lahir!");
                    birthdateInput.focus();
                    return;
                }

                // Jika custom URL dipilih, ambil URL dari input
                if (
                    musicSelect.value === "custom" &&
                    musicUrlInput.value.trim()
                ) {
                    currentMusicUrl = musicUrlInput.value.trim();
                    if (!currentMusicUrl.startsWith("http")) {
                        showErrorToast(
                            "Harap masukkan URL yang valid (dimulai dengan http/https)"
                        );
                        musicUrlInput.focus();
                        return;
                    }
                }

                // Reset tampilan sebelumnya
                resetDisplay();

                const birth = new Date(birthdate);
                const today = new Date();

                // Hitung umur
                let age = today.getFullYear() - birth.getFullYear();
                const monthDiff = today.getMonth() - birth.getMonth();
                if (
                    monthDiff < 0 ||
                    (monthDiff === 0 && today.getDate() < birth.getDate())
                ) {
                    age--;
                }

                // Cek apakah hari ini ulang tahun
                const isBirthday =
                    today.getDate() === birth.getDate() &&
                    today.getMonth() === birth.getMonth();

                if (isBirthday) {
                    // Tampilkan ucapan ulang tahun
                    showBirthdayMessage(name, age);

                    // Tampilkan kue dan lilin
                    birthdayDisplay.style.display = "block";

                    // Tampilkan carousel
                    birthdayCarousel.style.display = "block";

                    // Buat 5 lilin di atas kue
                    createCandles();

                    // Aktifkan efek spesial
                    activateBirthdayEffects();

                    // Mainkan musik OTOMATIS
                    playBirthdayMusic();

                    // Tampilkan toast ulang tahun
                    showBirthdayToast(name, age);

                    // Tampilkan alert
                    setTimeout(() => {
                        alert(
                            `üéÇ Selamat ulang tahun yang ke-${age}, ${name}! üéÇ\nKlik lilin untuk mematikannya.`
                        );
                    }, 500);
                } else {
                    // Tampilkan pesan bukan ulang tahun
                    showNormalMessage(name, age, birth, today);

                    // Tampilkan toast bukan ulang tahun
                    showNotBirthdayToast(name, age, birth, today);
                }
            }

            // ============================
            // FUNGSI BANTUAN
            // ============================

            // Fungsi tampilkan pesan ulang tahun
            function showBirthdayMessage(name, age) {
                const messageDiv = document.createElement("div");
                messageDiv.className = "birthday-message";
                messageDiv.innerHTML = `
                üéâ <strong>HAPPY BIRTHDAY ${name.toUpperCase()}!</strong> üéâ<br>
                <span style="font-size: 1.1em; color: #f34b4b;">Ulang Tahun Ke-${age}</span><br>
                <span style="font-size: 0.8em; color: #666;">Today is a celebration of you‚ú®</span>
            `;

                messageContainer.innerHTML = "";
                messageContainer.appendChild(messageDiv);
            }

            // Fungsi buat 5 lilin di atas kue
            function createCandles() {
                candlesContainer.innerHTML = "";

                // Selalu buat 5 lilin
                for (let i = 0; i < 5; i++) {
                    const candle = document.createElement("div");
                    candle.className = "candle";
                    candle.dataset.index = i;

                    const flame = document.createElement("div");
                    flame.className = `flame color${i + 1}`;

                    candle.appendChild(flame);
                    candlesContainer.appendChild(candle);

                    // Event listener untuk mematikan lilin
                    candle.addEventListener("click", function () {
                        if (!this.classList.contains("extinguished")) {
                            extinguishCandle(this);
                        }
                    });
                }
            }

            // Fungsi matikan lilin
            function extinguishCandle(candle) {
                const flame = candle.querySelector(".flame");

                flame.classList.add("extinguished");
                candle.classList.add("extinguished");

                // Hapus event listener
                candle.onclick = null;

                // Cek apakah semua lilin sudah padam
                setTimeout(() => {
                    checkAllCandlesExtinguished();
                }, 100);
            }

            // Fungsi cek semua lilin sudah padam
            function checkAllCandlesExtinguished() {
                const candles = candlesContainer.querySelectorAll(".candle");
                const extinguished = candlesContainer.querySelectorAll(
                    ".candle.extinguished"
                );

                if (
                    candles.length > 0 &&
                    candles.length === extinguished.length
                ) {
                    resetBtn.style.display = "block";
                    showCandlesOutToast();
                }
            }

            // Fungsi nyalakan kembali lilin
            function relightCandles() {
                const candles = candlesContainer.querySelectorAll(
                    ".candle.extinguished"
                );

                candles.forEach(candle => {
                    const flame = candle.querySelector(".flame");
                    flame.classList.remove("extinguished");
                    candle.classList.remove("extinguished");

                    // Tambah event listener kembali
                    candle.addEventListener("click", function () {
                        if (!this.classList.contains("extinguished")) {
                            extinguishCandle(this);
                        }
                    });
                });

                resetBtn.style.display = "none";
            }

            // Fungsi tampilkan pesan bukan ulang tahun
            function showNormalMessage(name, age, birth, today) {
                const nextBirthday = new Date(
                    today.getFullYear(),
                    birth.getMonth(),
                    birth.getDate()
                );
                if (nextBirthday < today) {
                    nextBirthday.setFullYear(nextBirthday.getFullYear() + 1);
                }

                const daysUntil = Math.ceil(
                    (nextBirthday - today) / (1000 * 60 * 60 * 24)
                );

                const messageDiv = document.createElement("div");
                messageDiv.className = "normal-message";
                messageDiv.innerHTML = `
                Hai <strong>${name}</strong>!<br><br>
                Umurmu sekarang: <strong>${age} tahun</strong><br><br>
                <span style="color: #2e7d32;">
                    Ulang tahun berikutnya: ${birth.getDate()}/${
                        birth.getMonth() + 1
                    }<br>
                    ${daysUntil} hari lagi menuju ulang tahun! üéâ
                </span>
            `;

                messageContainer.innerHTML = "";
                messageContainer.appendChild(messageDiv);

                birthdayDisplay.style.display = "none";
            }

            // Fungsi aktifkan efek ulang tahun
            function activateBirthdayEffects() {
                body.classList.add("birthday-bg");
                fireBg.classList.add("active");
                createConfetti();
            }

            // Fungsi buat konfeti
            function createConfetti() {
                for (let i = 0; i < 50; i++) {
                    setTimeout(() => {
                        const confetti = document.createElement("div");
                        confetti.className = "confetti";
                        confetti.style.left = Math.random() * 100 + "vw";
                        confetti.style.backgroundColor = `hsl(${
                            Math.random() * 360
                        }, 100%, 60%)`;
                        confetti.style.animationDuration =
                            Math.random() * 2 + 2 + "s";
                        confetti.style.width = Math.random() * 8 + 4 + "px";
                        confetti.style.height = confetti.style.width;

                        document.body.appendChild(confetti);

                        setTimeout(() => {
                            if (confetti.parentNode) {
                                confetti.remove();
                            }
                        }, 3000);
                    }, i * 30);
                }
            }

            // Fungsi reset tampilan
            function resetDisplay() {
                // Sembunyikan birthday display
                birthdayDisplay.style.display = "none";

                // Tampilkan kembali form box
                const formBox = document.getElementById("formBox");
                formBox.style.display = "block";

                // Reset efek
                messageContainer.innerHTML = "";
                body.classList.remove("birthday-bg");
                fireBg.classList.remove("active");
                resetBtn.style.display = "none";

                // Sembunyikan carousel
                birthdayCarousel.style.display = "none";

                // Hentikan musik
                stopBirthdayMusic();

                // Reset audio
                if (birthdayMusic) {
                    birthdayMusic.pause();
                    birthdayMusic.currentTime = 0;
                }

                // Hapus semua konfeti
                document.querySelectorAll(".confetti").forEach(c => c.remove());
            }

            // ============================
            // FUNGSI TOAST
            // ============================

            // Fungsi tampilkan toast ulang tahun
            function showBirthdayToast(name, age) {
                const toastContainer =
                    document.getElementById("toastContainer");

                const toastId = "birthdayToast-" + Date.now();
                const toastHTML = `
                    <div id="${toastId}" class="custom-toast" role="alert" aria-live="assertive" aria-atomic="true">
                        <div class="toast-header-custom d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.5em; margin-right: 8px;">üéÇ</span>
                                <strong class="me-auto">Selamat Ulang Tahun!</strong>
                            </div>
                            <button type="button" class="btn-close toast-close-btn" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body-custom">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.8em; margin-right: 10px;">üéâ</span>
                                <div>
                                    <strong>${name}</strong>, mat ulang tahun ke-<strong>${age}</strong>!<br>
                                    <small>Safe flight juga PANDAAAAAAAAüêºüêºüõ´‚úàÔ∏è</small>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                toastContainer.insertAdjacentHTML("beforeend", toastHTML);

                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, {
                    animation: true,
                    autohide: true,
                    delay: 5000
                });

                toast.show();

                // Hapus elemen toast setelah ditutup
                toastElement.addEventListener("hidden.bs.toast", function () {
                    toastElement.remove();
                });
            }

            // Fungsi tampilkan toast bukan ulang tahun
            function showNotBirthdayToast(name, age, birth, today) {
                const toastContainer =
                    document.getElementById("toastContainer");

                const toastId = "notBirthdayToast-" + Date.now();
                const toastHTML = `
                    <div id="${toastId}" class="custom-toast" role="alert" aria-live="assertive" aria-atomic="true">
                        <div class="toast-header-custom d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.5em; margin-right: 8px;">üìÖ</span>
                                <strong class="me-auto">Info Ulang Tahun</strong>
                            </div>
                            <button type="button" class="btn-close toast-close-btn" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body-custom">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.8em; margin-right: 10px;">üëã</span>
                                <div>
                                    Hai <strong>${name}</strong>!<br>
                                    <small>Hari ini bukan ulang tahunmu. Semoga harimu menyenangkan!</small>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                toastContainer.insertAdjacentHTML("beforeend", toastHTML);

                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, {
                    animation: true,
                    autohide: true,
                    delay: 4000
                });

                toast.show();

                // Hapus elemen toast setelah ditutup
                toastElement.addEventListener("hidden.bs.toast", function () {
                    toastElement.remove();
                });
            }

            // Fungsi tampilkan toast error
            function showErrorToast(message) {
                const toastContainer =
                    document.getElementById("toastContainer");

                const toastId = "errorToast-" + Date.now();
                const toastHTML = `
                    <div id="${toastId}" class="custom-toast" role="alert" aria-live="assertive" aria-atomic="true" style="background: linear-gradient(135deg, #f44336, #d32f2f);">
                        <div class="toast-header-custom d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.5em; margin-right: 8px;">‚ö†Ô∏è</span>
                                <strong class="me-auto">Peringatan</strong>
                            </div>
                            <button type="button" class="btn-close toast-close-btn" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body-custom">
                            ${message}
                        </div>
                    </div>
                `;

                toastContainer.insertAdjacentHTML("beforeend", toastHTML);

                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, {
                    animation: true,
                    autohide: true,
                    delay: 3000
                });

                toast.show();

                // Hapus elemen toast setelah ditutup
                toastElement.addEventListener("hidden.bs.toast", function () {
                    toastElement.remove();
                });
            }

            // Fungsi tampilkan toast biasa
            function showToast(message) {
                const toastContainer =
                    document.getElementById("toastContainer");

                const toastId = "toast-" + Date.now();
                const toastHTML = `
                    <div id="${toastId}" class="custom-toast" role="alert" aria-live="assertive" aria-atomic="true" style="background: linear-gradient(135deg, #4caf50, #2e7d32);">
                        <div class="toast-header-custom d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.5em; margin-right: 8px;">‚ÑπÔ∏è</span>
                                <strong class="me-auto">Informasi</strong>
                            </div>
                            <button type="button" class="btn-close toast-close-btn" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body-custom">
                            ${message}
                        </div>
                    </div>
                `;

                toastContainer.insertAdjacentHTML("beforeend", toastHTML);

                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, {
                    animation: true,
                    autohide: true,
                    delay: 3000
                });

                toast.show();

                // Hapus elemen toast setelah ditutup
                toastElement.addEventListener("hidden.bs.toast", function () {
                    toastElement.remove();
                });
            }

            // Fungsi tampilkan toast saat semua lilin padam
            function showCandlesOutToast() {
                const toastContainer =
                    document.getElementById("toastContainer");
                const name = nameInput.value.trim() || "Teman";

                const toastId = "candlesToast-" + Date.now();
                const toastHTML = `
                    <div id="${toastId}" class="custom-toast" role="alert" aria-live="assertive" aria-atomic="true" style="background: linear-gradient(135deg, #90afeb, #2768e7);">
                        <div class="toast-header-custom d-flex justify-content-between align-items-center">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.5em; margin-right: 8px;">üî•</span>
                                <strong class="me-auto">Semua Lilin Padam!</strong>
                            </div>
                            <button type="button" class="btn-close toast-close-btn" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body-custom">
                            <div class="d-flex align-items-center">
                                <span style="font-size: 1.8em; margin-right: 10px;">üéâ</span>
                                <div>
                                    Âøò„Çå„Å™Ëçâ<br>
                                    <small>In garden soft and blue,
a tiny bloom in morning‚Äôs hue,
with petals bright and hearts so true
It whisper ; "please, remember you"</small>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                toastContainer.insertAdjacentHTML("beforeend", toastHTML);

                const toastElement = document.getElementById(toastId);
                const toast = new bootstrap.Toast(toastElement, {
                    animation: true,
                    autohide: true,
                    delay: 12000
                });

                toast.show();

                // Hapus elemen toast setelah ditutup
                toastElement.addEventListener("hidden.bs.toast", function () {
                    toastElement.remove();
                });
            }

            // ============================
            // EVENT LISTENERS UTAMA
            // ============================

            submitBtn.addEventListener("click", checkBirthday);

            nameInput.addEventListener("keypress", e => {
                if (e.key === "Enter") checkBirthday();
            });

            birthdateInput.addEventListener("keypress", e => {
                if (e.key === "Enter") checkBirthday();
            });

            resetBtn.addEventListener("click", relightCandles);

            backBtn.addEventListener("click", resetDisplay);

            // ============================
            // INISIALISASI
            // ============================

            window.addEventListener("load", () => {
                nameInput.focus();
                birthdateInput.value = "";

                const today = new Date().toISOString().split("T")[0];
                birthdateInput.max = today;

                currentMusicUrl = musicLibrary.default.url;
            });

            // Cleanup saat halaman ditutup
            window.addEventListener("beforeunload", () => {
                stopBirthdayMusic();
            });
        </script>
    </body>
</html>
